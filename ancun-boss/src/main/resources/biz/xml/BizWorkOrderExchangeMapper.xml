<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.ancun.boss.persistence.biz.BizWorkOrderExchangeMapper">
  <resultMap id="BaseResultMap" type="com.ancun.boss.pojo.workorder.WorkOrderExchangePojo">
      <!--
        WARNING - @mbggenerated
        This element is automatically generated by MyBatis Generator, do not modify.
      -->
   <id column="ID" jdbcType="BIGINT" property="id" />
   <result column="ORDERNO" jdbcType="VARCHAR" property="orderno" />
   <result column="HANDLE_TIME" jdbcType="TIMESTAMP" property="handleTime" />
   <result column="ORGNO" jdbcType="VARCHAR" property="orgno" />
   <result column="HANDLE_USERNO" jdbcType="VARCHAR" property="handleUserno" />
   <result column="HANDLE_CONTENT" jdbcType="VARCHAR" property="handleContent" />
   <result column="STATUS" jdbcType="VARCHAR" property="status" />
   <result column="FINISH_TIME" jdbcType="TIMESTAMP" property="finishTime" />
   <result column="ORGNO_NAME" jdbcType="VARCHAR" property="orgnoName" />
   <result column="USER_NAME" jdbcType="VARCHAR" property="userName" />
  </resultMap>
  
  <select id="selectExchangeList" parameterType="com.ancun.boss.pojo.workorder.WorkOrderQueryInput" resultMap="BaseResultMap">
        select distinct
		    t1.ID,
		    t1.ORDERNO,
		    t1.HANDLE_TIME,
		    t1.ORGNO,
 		    t1.HANDLE_USERNO,
		    t1.HANDLE_CONTENT,
		    t1.STATUS,
		    t1.FINISH_TIME,
		    t2.NAME AS ORGNO_NAME,
	    	t3.USERNAME AS USER_NAME
        from
	        USER_WORK_ORDER_EXCHANGE_DETAIL_INFO t1
	        LEFT JOIN SYSTEM_BASIC_CONFIG t2 ON t1.ORGNO = t2.`CODE` AND t2.MOUDLECODE='ORG'
	        LEFT JOIN SYSTEM_USER_INFO t3 ON t1.HANDLE_USERNO = t3.`USERNO`
        where 
        	t1.ORDERNO = #{orderno,jdbcType=VARCHAR}
        order by t1.HANDLE_TIME desc 
  </select>

</mapper>